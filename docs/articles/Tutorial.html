<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package Tutorial • ebanks.package</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Package Tutorial">
<meta property="og:description" content="ebanks.package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ebanks.package</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Tutorial.html">Package Tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Tutorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="Tutorial_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="Tutorial_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Package Tutorial</h1>
                        <h4 class="author">Ariel Ebanks</h4>
            
            <h4 class="date">11/16/2020</h4>
      
      
      <div class="hidden name"><code>Tutorial.Rmd</code></div>

    </div>

    
    
<div id="processing-operational-taxonomic-unit-otu-abundance-matrices-and-sample-data-for-downstream-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-operational-taxonomic-unit-otu-abundance-matrices-and-sample-data-for-downstream-analysis" class="anchor"></a>Processing operational taxonomic unit (OTU) abundance matrices and sample data for downstream analysis</h3>
</div>
<div id="ebanks-package" class="section level2">
<h2 class="hasAnchor">
<a href="#ebanks-package" class="anchor"></a>ebanks.package</h2>
<p>Once amplicon data is processed, it can be returned as an abundance matrix, data table of OTU taxonomic information, and data table with sample information. The format of these datasets vary depending on the program used to process the amplicon data. The purpose of this package is to turn these separate datasets into one usable <strong><code>taxmap</code></strong> object that can be easily manipulated and analyzed with functions from <strong><code>metacoder</code></strong>, <strong><code>taxa</code></strong>, and <strong><code>phyloseq</code></strong>.</p>
<p>Let’s install and load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"arielebanks/ebanks.package"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ebanks.package</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: replacing previous import 'phyloseq::filter_taxa' by
## 'taxa::filter_taxa' when loading 'ebanks.package'</code></pre>
<p>This tutorial will use a sample data table and a fungal OTU abundance matrix. Before you read in the data, make sure <strong><code>tidyverse</code></strong> is loaded.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<p>Now, let’s read in and inspect the sample data table.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spartina_sample</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"../inst/extdata/spartina_sample.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## -- Column specification --------------------------------------------------------
## cols(
##   .default = col_double(),
##   sample_id = col_character(),
##   tissue = col_character(),
##   site = col_character(),
##   treatment = col_character()
## )
## i Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">spartina_sample</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 117 x 3,505
##    sample_id tissue site  treatment    pH    mS   tds   PAH   PWR   DWR
##    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 S6.BN.L1  Leaf   BJ    non-oiled  7.11  42.5  3188 8.38  0.7   0.4  
##  2 S6.BN.L10 Leaf   BJ    non-oiled  7.07  49.9  3822 2.40  0.516 0.311
##  3 S6.BN.L2  Leaf   BJ    non-oiled  7.34  55.5  4291 7.08  0.674 0.444
##  4 S6.BN.L3  Leaf   BJ    non-oiled  7.42  35.1  2570 0.570 0.712 0.483
##  5 S6.BN.L4  Leaf   BJ    non-oiled  7.35  51.9  3986 0.580 0.75  0.444
##  6 S6.BN.L5  Leaf   BJ    non-oiled  7.27  33.9  2506 9.13  0.821 0.5  
##  7 S6.BN.L6  Leaf   BJ    non-oiled  7.05  41.8  3125 5.64  0.783 0.5  
##  8 S6.BN.L7  Leaf   BJ    non-oiled  7.01  46.3  3680 8.24  0.943 0.308
##  9 S6.BN.L8  Leaf   BJ    non-oiled  7.1   45    3417 7.88  0.674 0.483
## 10 S6.BN.L9  Leaf   BJ    non-oiled  7.05  31.9  2850 0.55  0.688 0.444
## # ... with 107 more rows, and 3,495 more variables: derep_917 &lt;dbl&gt;,
## #   derep_9798 &lt;dbl&gt;, derep_911 &lt;dbl&gt;, derep_9795 &lt;dbl&gt;, derep_10330 &lt;dbl&gt;,
## #   derep_6548 &lt;dbl&gt;, derep_919 &lt;dbl&gt;, derep_9792 &lt;dbl&gt;, derep_3759 &lt;dbl&gt;,
## #   derep_121805 &lt;dbl&gt;, derep_3200 &lt;dbl&gt;, derep_3750 &lt;dbl&gt;, derep_18103 &lt;dbl&gt;,
## #   derep_3754 &lt;dbl&gt;, derep_2332 &lt;dbl&gt;, derep_2336 &lt;dbl&gt;, derep_2335 &lt;dbl&gt;,
## #   derep_6147 &lt;dbl&gt;, derep_285 &lt;dbl&gt;, derep_2339 &lt;dbl&gt;, derep_2338 &lt;dbl&gt;,
## #   derep_9642 &lt;dbl&gt;, derep_17856 &lt;dbl&gt;, derep_55543 &lt;dbl&gt;, derep_16459 &lt;dbl&gt;,
## #   derep_17859 &lt;dbl&gt;, derep_17858 &lt;dbl&gt;, derep_16670 &lt;dbl&gt;, derep_29068 &lt;dbl&gt;,
## #   derep_9790 &lt;dbl&gt;, derep_29065 &lt;dbl&gt;, derep_16679 &lt;dbl&gt;, derep_29061 &lt;dbl&gt;,
## #   derep_11889 &lt;dbl&gt;, derep_16664 &lt;dbl&gt;, derep_98748 &lt;dbl&gt;, derep_34252 &lt;dbl&gt;,
## #   derep_17216 &lt;dbl&gt;, derep_57372 &lt;dbl&gt;, derep_58810 &lt;dbl&gt;, derep_57371 &lt;dbl&gt;,
## #   derep_19887 &lt;dbl&gt;, derep_25531 &lt;dbl&gt;, derep_9267 &lt;dbl&gt;, derep_87173 &lt;dbl&gt;,
## #   derep_90221 &lt;dbl&gt;, derep_1821 &lt;dbl&gt;, derep_866 &lt;dbl&gt;, derep_6430 &lt;dbl&gt;,
## #   derep_6431 &lt;dbl&gt;, derep_6433 &lt;dbl&gt;, derep_3752 &lt;dbl&gt;, derep_5813 &lt;dbl&gt;,
## #   derep_20437 &lt;dbl&gt;, derep_24488 &lt;dbl&gt;, derep_25175 &lt;dbl&gt;, derep_25174 &lt;dbl&gt;,
## #   derep_43472 &lt;dbl&gt;, derep_25176 &lt;dbl&gt;, derep_34652 &lt;dbl&gt;, derep_34650 &lt;dbl&gt;,
## #   derep_34651 &lt;dbl&gt;, derep_24487 &lt;dbl&gt;, derep_7233 &lt;dbl&gt;, derep_18106 &lt;dbl&gt;,
## #   derep_7237 &lt;dbl&gt;, derep_6899 &lt;dbl&gt;, derep_19459 &lt;dbl&gt;, derep_16183 &lt;dbl&gt;,
## #   derep_76325 &lt;dbl&gt;, derep_7051 &lt;dbl&gt;, derep_25192 &lt;dbl&gt;, derep_59510 &lt;dbl&gt;,
## #   derep_7457 &lt;dbl&gt;, derep_68136 &lt;dbl&gt;, derep_29204 &lt;dbl&gt;, derep_29202 &lt;dbl&gt;,
## #   derep_118332 &lt;dbl&gt;, derep_28072 &lt;dbl&gt;, derep_33936 &lt;dbl&gt;, derep_7431 &lt;dbl&gt;,
## #   derep_7437 &lt;dbl&gt;, derep_7436 &lt;dbl&gt;, derep_7435 &lt;dbl&gt;, derep_1305 &lt;dbl&gt;,
## #   derep_1302 &lt;dbl&gt;, derep_1301 &lt;dbl&gt;, derep_13915 &lt;dbl&gt;, derep_145921 &lt;dbl&gt;,
## #   derep_96106 &lt;dbl&gt;, derep_68829 &lt;dbl&gt;, derep_40077 &lt;dbl&gt;, derep_68399 &lt;dbl&gt;,
## #   derep_40073 &lt;dbl&gt;, derep_60385 &lt;dbl&gt;, derep_40078 &lt;dbl&gt;, derep_8520 &lt;dbl&gt;,
## #   derep_5802 &lt;dbl&gt;, derep_8523 &lt;dbl&gt;, derep_8526 &lt;dbl&gt;, ...</code></pre>
<p>In this study, leaves, roots, and rhizosphere samples were collected from Spartina alterniflora in oiled and non-oiled sites along the Louisiana Gulf Coast. It displays samples as rows and environmental data and fungal OTUs as columns.</p>
<p>Let’s do the same for the abundance matrix.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spartina_otu</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"../inst/extdata/spartina_otu.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## -- Column specification --------------------------------------------------------
## cols(
##   .default = col_double(),
##   out_id = col_character(),
##   taxa_assignment = col_character()
## )
## i Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">spartina_otu</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3,495 x 119
##    out_id taxa_assignment S6.BO.S9 S6.BN.L8 S6.BN.R7 S6.FO.L1 S6.FN.L5 S6.FO.R8
##    &lt;chr&gt;  &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 derep~ None                   4       23       28        8        1       42
##  2 derep~ None                   0        0        0        0        0        0
##  3 derep~ KJ484706|k__Fu~        0        0        0        0        0        0
##  4 derep~ None                   0        0        0        0        0        0
##  5 derep~ KJ481209|k__Fu~        0        0        0        0        0        0
##  6 derep~ None                   0        0        0        0        0        0
##  7 derep~ None                   1        0        0        0        0        0
##  8 derep~ None                   0        0        0        0        0        0
##  9 derep~ KF359557|k__Fu~        0        0        0        5        0        0
## 10 derep~ None                   0        0        0        0        0        0
## # ... with 3,485 more rows, and 111 more variables: S6.FN.L4 &lt;dbl&gt;,
## #   S6.BN.S2 &lt;dbl&gt;, S6.FN.L10 &lt;dbl&gt;, S6.BN.R5 &lt;dbl&gt;, S6.BN.R4 &lt;dbl&gt;,
## #   S6.FN.R7 &lt;dbl&gt;, S6.BN.R1 &lt;dbl&gt;, S6.BN.L9 &lt;dbl&gt;, S6.BN.R2 &lt;dbl&gt;,
## #   S6.FO.L2 &lt;dbl&gt;, S6.BN.R9 &lt;dbl&gt;, S6.FN.S5 &lt;dbl&gt;, S6.FO.L3 &lt;dbl&gt;,
## #   S6.BO.R7 &lt;dbl&gt;, S6.BN.R3 &lt;dbl&gt;, S6.BN.L2 &lt;dbl&gt;, S6.BO.R10 &lt;dbl&gt;,
## #   S6.FN.S1 &lt;dbl&gt;, S6.BO.S8 &lt;dbl&gt;, S6.BO.R8 &lt;dbl&gt;, S6.BO.S5 &lt;dbl&gt;,
## #   S6.BO.S7 &lt;dbl&gt;, S6.BN.S9 &lt;dbl&gt;, S6.BN.S10 &lt;dbl&gt;, S6.BO.S4 &lt;dbl&gt;,
## #   S6.BN.S5 &lt;dbl&gt;, S6.BN.S8 &lt;dbl&gt;, S6.FO.S5 &lt;dbl&gt;, S6.FN.S7 &lt;dbl&gt;,
## #   S6.BO.S10 &lt;dbl&gt;, S6.FO.S6 &lt;dbl&gt;, S6.FO.S8 &lt;dbl&gt;, S6.FO.S2 &lt;dbl&gt;,
## #   S6.BN.S4 &lt;dbl&gt;, S6.BO.S1 &lt;dbl&gt;, S6.BO.S2 &lt;dbl&gt;, S6.BO.S6 &lt;dbl&gt;,
## #   S6.FN.L2 &lt;dbl&gt;, S6.BN.L3 &lt;dbl&gt;, S6.FN.L8 &lt;dbl&gt;, S6.BN.L10 &lt;dbl&gt;,
## #   S6.BO.L9 &lt;dbl&gt;, S6.FO.L6 &lt;dbl&gt;, S6.FO.R9 &lt;dbl&gt;, S6.FO.R3 &lt;dbl&gt;,
## #   S6.FN.R10 &lt;dbl&gt;, S6.BO.R5 &lt;dbl&gt;, S6.BO.L3 &lt;dbl&gt;, S6.FO.S10 &lt;dbl&gt;,
## #   S6.FO.R6 &lt;dbl&gt;, S6.FN.S4 &lt;dbl&gt;, S6.FN.S10 &lt;dbl&gt;, S6.FO.S3 &lt;dbl&gt;,
## #   S6.BN.L7 &lt;dbl&gt;, S6.BN.S7 &lt;dbl&gt;, S6.BN.S3 &lt;dbl&gt;, S6.FN.S8 &lt;dbl&gt;,
## #   S6.FO.S1 &lt;dbl&gt;, S6.BN.R10 &lt;dbl&gt;, S6.FN.R9 &lt;dbl&gt;, S6.BN.R8 &lt;dbl&gt;,
## #   S6.FN.S6 &lt;dbl&gt;, S6.FN.S2 &lt;dbl&gt;, S6.FN.S9 &lt;dbl&gt;, S6.BN.L5 &lt;dbl&gt;,
## #   S6.BO.R6 &lt;dbl&gt;, S6.BO.L10 &lt;dbl&gt;, S6.FO.R2 &lt;dbl&gt;, S6.FN.L9 &lt;dbl&gt;,
## #   S6.FN.L3 &lt;dbl&gt;, S6.FO.L10 &lt;dbl&gt;, S6.FN.L1 &lt;dbl&gt;, S6.FO.S7 &lt;dbl&gt;,
## #   S6.FN.R6 &lt;dbl&gt;, S6.FO.S9 &lt;dbl&gt;, S6.BO.S3 &lt;dbl&gt;, S6.BN.S6 &lt;dbl&gt;,
## #   S6.BO.L2 &lt;dbl&gt;, S6.BO.L8 &lt;dbl&gt;, S6.FO.R4 &lt;dbl&gt;, S6.FN.R1 &lt;dbl&gt;,
## #   S6.BN.L6 &lt;dbl&gt;, S6.BO.R3 &lt;dbl&gt;, S6.BO.R2 &lt;dbl&gt;, S6.FO.S4 &lt;dbl&gt;,
## #   S6.FN.S3 &lt;dbl&gt;, S6.FO.R10 &lt;dbl&gt;, S6.FO.R1 &lt;dbl&gt;, S6.BO.L1 &lt;dbl&gt;,
## #   S6.BO.L5 &lt;dbl&gt;, S6.FO.L7 &lt;dbl&gt;, S6.FN.L7 &lt;dbl&gt;, S6.FN.L6 &lt;dbl&gt;,
## #   S6.FO.L9 &lt;dbl&gt;, S6.FN.R5 &lt;dbl&gt;, S6.FN.R4 &lt;dbl&gt;, S6.BO.L6 &lt;dbl&gt;,
## #   S6.BN.R6 &lt;dbl&gt;, S6.FO.L8 &lt;dbl&gt;, S6.FO.R5 &lt;dbl&gt;, ...</code></pre>
<p>This abundance matrix is formatted properly with fungal OTUs as rows and samples as columns, but the “taxa_assignment” column is not formatted in a way we can use meaningfully. Also, there is a typo in the first column - “out_id” should read “otu_id”.</p>
<div id="parse-taxonomic-information-from-abundance-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#parse-taxonomic-information-from-abundance-matrix" class="anchor"></a>Parse taxonomic information from abundance matrix</h3>
<p>In order to visualize and analyze fungal abundance, richness, and diversity, taxonomic information should be parsed from the abundance matrix. This function takes an OTU dataset and creates a <strong><code>taxmap</code></strong> object with an abundance matrix and parsed taxonomic classifications in two separate tibbles. Additionally, this function will replace “None” with “NAs” in the “taxa_assignment” column and fix the “otu_id” column typo in our <strong><code>spartina_otu</code></strong> dataset.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_tax.html">parse_tax</a></span><span class="op">(</span><span class="va">spartina_otu</span><span class="op">)</span></code></pre></div>
<pre><code>## The following 2111 of 3495 (60.4%) input indexes have `NA` in their classifications:
##    1, 2, 4, 6, 7, 8, 10 ... 3481, 3482, 3483, 3484, 3487, 3488</code></pre>
<pre><code>## Warning: `as.tbl()` is deprecated as of dplyr 1.0.0.
## Please use `tibble::as_tibble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;Taxmap&gt;
##   1328 taxa: aab. NA ... bzc. Phialocephala_[truncated]
##   1328 edges: NA-&gt;aab, NA-&gt;aac, NA-&gt;aad ... axe-&gt;bzb, aoj-&gt;bzc
##   2 data sets:
##     tax_data:
##       # A tibble: 3,495 x 120
##         taxon_id otu_id taxa_assignment S6.BO.S9 S6.BN.L8 S6.BN.R7
##         &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##       1 aab      derep~ &lt;NA&gt;                   4       23       28
##       2 aab      derep~ &lt;NA&gt;                   0        0        0
##       3 axf      derep~ KJ484706|k__Fu~        0        0        0
##       # ... with 3,492 more rows, and 114 more variables:
##       #   S6.FO.L1 &lt;dbl&gt;, S6.FN.L5 &lt;dbl&gt;, S6.FO.R8 &lt;dbl&gt;,
##       #   S6.FN.L4 &lt;dbl&gt;, S6.BN.S2 &lt;dbl&gt;, S6.FN.L10 &lt;dbl&gt;,
##       #   S6.BN.R5 &lt;dbl&gt;, S6.BN.R4 &lt;dbl&gt;, S6.FN.R7 &lt;dbl&gt;,
##       #   S6.BN.R1 &lt;dbl&gt;, ...
##     class_data:
##       # A tibble: 11,799 x 5
##         taxon_id input_index tax_rank   tax_name regex_match      
##         &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;            
##       1 aab                1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;             
##       2 aab                2 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;             
##       3 aac                3 KJ484706|k Fungi    KJ484706|k__Fungi
##       # ... with 11,796 more rows
##   0 functions:</code></pre>
<p>Our <strong><code>taxmap</code></strong> object says that there are 1328 unique taxa in the dataset, and provides the IDs each was assigned. These IDs can be found in the new column “taxon_id”. It also tells us how closely each one will appear in our heat tree. We also see that there are now 2 datasets - <strong><code>obj$data$tax_data</code></strong> and <strong><code>obj$data$class_data</code></strong>.</p>
</div>
<div id="manipulating-the-abundance-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#manipulating-the-abundance-matrix" class="anchor"></a>Manipulating the abundance matrix</h3>
<p>Now, we can remove any low abundance counts that may be present due to error, rarefy our counts in case of uneven sampling, and get abundances per taxon and sample tissue type. This function will replace any counts less than 5 with 0 in <strong><code>obj$data$tax_data</code></strong>, and then remove them from the dataset. It will also provide 2 new datasets called <strong><code>obj$data$taxon_abundance</code></strong> and <strong><code>obj$data$tax_sample</code></strong> where abundances per taxon and tissue type can be found. We’ll use the <strong><code>taxmap</code></strong> object generated from the previous function as the input here, but we’ll name our new object something different so we can compare them.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">obj_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fung_abund.html">fung_abund</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></code></pre></div>
<pre><code>## No `cols` specified, so using all numeric columns:
##    S6.BO.S9, S6.BN.L8, S6.BN.R7 ... S6.FN.R2, S6.BO.R1, S6.BO.L7</code></pre>
<pre><code>## Zeroing 3923 of 408915 counts less than 5.</code></pre>
<pre><code>## No `cols` specified, so using all numeric columns:
##    S6.BO.S9, S6.BN.L8, S6.BN.R7 ... S6.FN.R2, S6.BO.R1, S6.BO.L7</code></pre>
<pre><code>## Calculating proportions from counts for 117 columns for 2725 observations.</code></pre>
<pre><code>## Summing per-taxon counts from 117 columns for 1222 taxa</code></pre>
<pre><code>## NOTE: Using the "groups" option without the "cols" option can yeild incorrect results if the column order is different from the group order.</code></pre>
<pre><code>## No `cols` specified, so using all numeric columns:
##    S6.BN.L1, S6.BN.L10, S6.BN.L2 ... S6.FO.S7, S6.FO.S8, S6.FO.S9</code></pre>
<pre><code>## Calculating number of samples with a value greater than 0 for 117 columns in 3 groups for 1222 observations</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">obj_complete</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;Taxmap&gt;
##   1222 taxa: aab. NA ... bzc. Phialocephala_[truncated]
##   1222 edges: NA-&gt;aab, NA-&gt;aac, NA-&gt;aad ... axe-&gt;bzb, aoj-&gt;bzc
##   4 data sets:
##     tax_data:
##       # A tibble: 2,725 x 118
##         taxon_id S6.BO.S9 S6.BN.L8 S6.BN.R7 S6.FO.L1 S6.FN.L5 S6.FO.R8
##         &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##       1 aab             0 0.000341 0.000290  8.83e-5        0 0.000575
##       2 aab             0 0        0         0.             0 0       
##       3 axf             0 0        0         0.             0 0       
##       # ... with 2,722 more rows, and 111 more variables:
##       #   S6.FN.L4 &lt;dbl&gt;, S6.BN.S2 &lt;dbl&gt;, S6.FN.L10 &lt;dbl&gt;,
##       #   S6.BN.R5 &lt;dbl&gt;, S6.BN.R4 &lt;dbl&gt;, S6.FN.R7 &lt;dbl&gt;,
##       #   S6.BN.R1 &lt;dbl&gt;, S6.BN.L9 &lt;dbl&gt;, S6.BN.R2 &lt;dbl&gt;,
##       #   S6.FO.L2 &lt;dbl&gt;, ...
##     class_data:
##       # A tibble: 11,691 x 5
##         taxon_id input_index tax_rank   tax_name regex_match      
##         &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;            
##       1 aab                1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;             
##       2 aab                2 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;             
##       3 aac                3 KJ484706|k Fungi    KJ484706|k__Fungi
##       # ... with 11,688 more rows
##     taxon_abundance:
##       # A tibble: 1,222 x 118
##         taxon_id S6.BN.L1 S6.BN.L10 S6.BN.L2 S6.BN.L3 S6.BN.L4
##         &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##       1 aab        0.983      0.441   0.984   0.995     0.989 
##       2 aac        0.0166     0.559   0.0163  0.00520   0.0109
##       3 aad        0          0       0       0         0     
##       # ... with 1,219 more rows, and 112 more variables:
##       #   S6.BN.L5 &lt;dbl&gt;, S6.BN.L6 &lt;dbl&gt;, S6.BN.L7 &lt;dbl&gt;,
##       #   S6.BN.L8 &lt;dbl&gt;, S6.BN.L9 &lt;dbl&gt;, S6.BN.R1 &lt;dbl&gt;,
##       #   S6.BN.R10 &lt;dbl&gt;, S6.BN.R2 &lt;dbl&gt;, S6.BN.R3 &lt;dbl&gt;,
##       #   S6.BN.R4 &lt;dbl&gt;, ...
##     tax_sample:
##       # A tibble: 1,222 x 4
##         taxon_id  Leaf  Root  Soil
##         &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##       1 aab         38    40    39
##       2 aac         38    40    39
##       3 aad          0     5     9
##       # ... with 1,219 more rows
##   0 functions:</code></pre>
</div>
</div>
<div id="visualize-abundances-in-all-samples-using-heat-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-abundances-in-all-samples-using-heat-tree" class="anchor"></a>Visualize abundances in all samples using heat tree</h2>
<p>Now we can visualize the fungal abundance present in all samples by creating a heat tree from <strong><code>obj_complete</code></strong>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fung_abund_tree.html">fung_abund_tree</a></span><span class="op">(</span><span class="va">obj_complete</span><span class="op">)</span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ariel Ebanks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
